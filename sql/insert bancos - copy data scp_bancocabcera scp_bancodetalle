/****** Script for SelectTopNRows command from SSMS  ******/
delete from scp.dbo.vsj_bancodetalle
where 1=1;

delete from scp.dbo.vsj_bancocabecera
where 1=1;

insert into scp.dbo.vsj_bancocabecera(
[txt_anoproceso]
      ,[ind_tipocuenta]
      ,[flg_saldo]
      ,[txt_correlativo]
      ,[cod_mes]
      ,[fec_fecha]
      ,[cod_ctacontable]
      ,[cod_destino]
      ,[cod_tipomoneda]
      ,[txt_glosa]
      ,[txt_cheque]
      ,[num_debesol]
      ,[num_habersol]
      ,[num_debedolar]
      ,[num_haberdolar]
      ,[num_debemo]
      ,[num_habermo]
      ,[flg_enviado]
      ,[cod_origenenlace]
      ,[cod_comprobanteenlace]
      ,[flg_im]
      ,[fec_fregistro]
      ,[cod_uregistro]
      ,[fec_factualiza]
      ,[cod_uactualiza]
)
SELECT [txt_anoproceso]
      ,[ind_tipocuenta]
      ,[flg_saldo]
      ,[txt_correlativo]
      ,[cod_mes]
      ,[fec_fecha]
      ,[cod_ctacontable]
      ,[cod_destino]
      ,[cod_tipomoneda]
      ,[txt_glosa]
      ,[txt_cheque]
      ,[num_debesol]
      ,[num_habersol]
      ,[num_debedolar]
      ,[num_haberdolar]
      ,[num_debemo]
      ,[num_habermo]
      ,[flg_enviado]
      ,[cod_origenenlace]
      ,[cod_comprobanteenlace]
      ,[flg_im]
      ,[fec_fregistro]
      ,[cod_uregistro]
      ,[fec_factualiza]
      ,[cod_uactualiza]
  FROM [SCP].[dbo].[scp_bancocabecera]
  where txt_anoproceso in ('2015','2016')
  order by fec_fecha

  insert into scp.dbo.vsj_bancodetalle(
[num_item],
cod_bancocabecera,
      [txt_anoproceso]
      ,[ind_tipocuenta]
      ,[flg_saldo]
      ,[txt_correlativo]
      ,[cod_mes]
      ,[fec_fecha]
      ,[cod_proyecto]
      ,[cod_tercero]
      ,[txt_glosaitem]
      ,[cod_destino]
      ,[txt_cheque]
      ,[cod_tipomoneda]
      ,[cod_ctaespecial]
      ,[cod_ctaproyecto]
      ,[cod_contraparte]
      ,[cod_financiera]
      ,[cod_ctacontable]
      ,[cod_contracta]
      ,[num_tcvdolar]
      ,[num_debesol]
      ,[num_habersol]
      ,[num_debedolar]
      ,[num_haberdolar]
      ,[num_tcmo]
      ,[num_debemo]
      ,[num_habermo]
      ,[cod_tipogasto]
      ,[cod_tipoingreso]
      ,[cod_formapago]
      ,[txt_detallepago]
      ,[cod_destinoitem]
      ,[cod_tipocomprobantepago]
      ,[txt_seriecomprobantepago]
      ,[txt_comprobantepago]
      ,[fec_comprobantepago]
      ,[flg_Anula]
      ,[num_saldosol]
      ,[num_saldodolar]
      ,[num_saldomo]
      ,[flg_im]
      ,[fec_fregistro]
      ,[cod_uregistro]
      ,[fec_factualiza]
      ,[cod_uactualiza]
)  select
   bd.[num_item],
bc.cod_bancocabecera
,bd.[txt_anoproceso]
      ,bd.[ind_tipocuenta]
      ,bd.[flg_saldo]
      ,bd.[txt_correlativo]
      ,bd.[cod_mes]
      ,bd.[fec_fecha]
      ,bd.[cod_proyecto]
      ,bd.[cod_tercero]
      ,bd.[txt_glosaitem]
      ,bd.[cod_destino]
      ,bd.[txt_cheque]
      ,bd.[cod_tipomoneda]
      ,bd.[cod_ctaespecial]
      ,bd.[cod_ctaproyecto]
      ,bd.[cod_contraparte]
      ,bd.[cod_financiera]
      ,bd.[cod_ctacontable]
      ,bd.[cod_contracta]
      ,bd.[num_tcvdolar]
      ,bd.[num_debesol]
      ,bd.[num_habersol]
      ,bd.[num_debedolar]
      ,bd.[num_haberdolar]
      ,bd.[num_tcmo]
      ,bd.[num_debemo]
      ,bd.[num_habermo]
      ,bd.[cod_tipogasto]
      ,bd.[cod_tipoingreso]
      ,bd.[cod_formapago]
      ,bd.[txt_detallepago]
      ,bd.[cod_destinoitem]
      ,bd.[cod_tipocomprobantepago]
      ,bd.[txt_seriecomprobantepago]
      ,bd.[txt_comprobantepago]
      ,bd.[fec_comprobantepago]
      ,bd.[flg_Anula]
      ,bd.[num_saldosol]
      ,bd.[num_saldodolar]
      ,bd.[num_saldomo]
      ,bd.[flg_im]
      ,bd.[fec_fregistro]
      ,bd.[cod_uregistro]
      ,bd.[fec_factualiza]
      ,bd.[cod_uactualiza]
  FROM [SCP].[dbo].[scp_bancodetalle]   bd inner join scp.dbo.vsj_bancocabecera  bc
  on  bd.[txt_anoproceso]=bc.txt_anoproceso
      and bd.[ind_tipocuenta]=bc.ind_tipocuenta
      and bd.[flg_saldo]=bc.flg_saldo
      and bd.[txt_correlativo]=bc.txt_correlativo
	where bd.txt_anoproceso in ('2015','2016')
  order by bc.cod_bancocabecera,bd.num_item