/****** Script for SelectTopNRows command from SSMS  ******/
--delete from scp.dbo.vsj_cajabanco
--where 1=1;

insert into scp.dbo.vsj_cajabanco(
      [txt_anoproceso]
      ,[ind_tipocuenta]
      ,[txt_correlativo]
      ,[cod_mes]
      ,[fec_fecha]
      ,[cod_proyecto]
      ,[cod_tercero]
      ,[txt_glosaitem]
      ,[cod_destino]
      ,[cod_tipomoneda]
      ,[cod_ctaespecial]
      ,[cod_ctaproyecto]
      ,[cod_contraparte]
      ,[cod_financiera]
      ,[cod_ctacontable]
      ,[cod_contracta]
      ,[num_debesol]
      ,[num_habersol]
      ,[num_debedolar]
      ,[num_haberdolar]
      ,[num_debemo]
      ,[num_habermo]
      ,[flg_Anula]
      ,[flg_enviado]
      ,[cod_origenenlace]
      ,[cod_comprobanteenlace]
      ,[cod_destinoitem]
      ,[cod_tipocomprobantepago]
      ,[txt_seriecomprobantepago]
      ,[txt_comprobantepago]
      ,[fec_comprobantepago]
      ,[fec_fregistro]
      ,[cod_uregistro]
      ,[fec_factualiza]
      ,[cod_uactualiza]
      ,[cod_tipomov] -- New Field
)
SELECT [txt_anoproceso]
      ,[ind_tipocuenta]
      ,[txt_correlativo]
      ,[cod_mes]
      ,[fec_fecha]
      ,[cod_proyecto]
      ,[cod_tercero]
      ,[txt_glosaitem]
      ,[cod_destino]
      ,[cod_tipomoneda]
      ,[cod_ctaespecial]
      ,[cod_ctaproyecto]
      ,[cod_contraparte]
      ,[cod_financiera]
      ,[cod_ctacontable]
      ,[cod_contracta]
      ,[num_debesol]
      ,[num_habersol]
      ,[num_debedolar]
      ,[num_haberdolar]
      ,[num_debemo]
      ,[num_habermo]
      ,[flg_Anula]
      ,[flg_enviado]
      ,[cod_origenenlace]
      ,[cod_comprobanteenlace]
      ,[cod_destinoitem]
      ,[cod_tipocomprobantepago]
      ,[txt_seriecomprobantepago]
      ,[txt_comprobantepago]
      ,[fec_comprobantepago]
      ,[fec_fregistro]
      ,[cod_uregistro]
      ,[fec_factualiza]
      ,[cod_uactualiza]
      ,2
  FROM [SCP].[dbo].[scp_cajabanco]
  where txt_anoproceso in ('2015','2016','2017','2018')
  order by fec_fecha
